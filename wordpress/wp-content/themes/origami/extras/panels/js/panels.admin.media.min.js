/* Received errors from Closure Compiler API:
Error(22): Too many compiles performed recently.  Try again later.
(Using fallback minifier)
*/

jQuery(function($){var originalInsert=wp.media.editor.insert;wp.media.editor.insert=function(h){if(!$('#wp-content-wrap').hasClass('panels-active'))return originalInsert(h);if(h.indexOf('[gallery')!==-1){var attachments=wp.media.gallery.attachments(wp.shortcode.next('gallery',h).shortcode);var ids=attachments.models.map(function(e){return e.id});var panel=$('#panels-dialog').panelsCreatePanel('SiteOrigin_Widgets_Gallery',{'ids':ids.join(',')});if(panel==null)originalInsert(h);else panels.addPanel(panel,null,null,true);return;}
else if(h.indexOf('<a ')!==-1||h.indexOf('<img ')!==-1){var $el=$(h);var panel;if($el.prop("tagName")=='A'&&$el.children().eq(0).prop('tagName')=='IMG'){panel=$('#panels-dialog').panelsCreatePanel('SiteOrigin_Widgets_Image',{'href':$el.attr('href'),'src':$el.children().eq(0).attr('src')});}
else if($el.prop("tagName")=='IMG'){panel=$('#panels-dialog').panelsCreatePanel('SiteOrigin_Widgets_Image',{'src':$el.children().eq(0).attr('src')});}
if(panel==null)originalInsert(h);else panels.addPanel(panel,null,null,true);return;}
originalInsert(h);}
$('.so-gallery-widget-select-attachments').live('click',function(event){if(typeof wp==='undefined'||!wp.media||!wp.media.gallery)return;event.preventDefault();var $$=$(this);var dialog=$('.panels-admin-dialog:visible');var val=dialog.find('*[name$="[ids]"]').val();if(val.indexOf('{demo')===0||val.indexOf('{default')===0)val='-';if(val==''&&$('#post_ID').val()==null)val='-';dialog.find('.ui-dialog-content').dialog('close');var frame=wp.media.gallery.edit('[gallery ids="'+val+'"]');frame.state('gallery-edit').on('update',function(selection){dialog.find('.ui-dialog-content').dialog('open');var ids=selection.models.map(function(e){return e.id});dialog.find('input[name$="[ids]"]').val(ids.join(','));});frame.on('escape',function(){dialog.find('.ui-dialog-content').dialog('open');});return false;});});